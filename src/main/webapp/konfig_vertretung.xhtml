<!DOCTYPE html>
<html 
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
	
	<h:head>
		<title>Vertretungsplan#{konfig.suffixTitle}</title>
		<f:metadata>
    		<f:viewAction action="#{weiterleitung.noVertretungKonfig}" />
		</f:metadata>
		<f:event type="preRenderView" listener="#{konfig.addHeader}" />
		<link rel="icon" type="image/png" href="#{resource['/img/favicon.png']}" />
		<h:outputStylesheet library="css" name="#{konfig.css}" />
		<h:outputScript library="js" name="topMenu.js" />
		<style>
			.ui-fileupload-buttonbar {
				background:none;
				border:none;
			}
			
			.ui-fileupload-content {
				display:none;
			}
		</style>
	</h:head>
	
	<h:body style="background-color:#{themeService.backgroundColor};">
		<p:growl id="message" showDetail="true"/>
		
		<p:confirmDialog global="true">
			<div style="text-align:center">
				<p:commandButton value="Nein" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
				<p:commandButton value="Ja" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
			</div>
		</p:confirmDialog>
		
		<div id="hidden-div">
		
<!-- Side Menu -->
			<h:form style="position:fixed;z-index:100">
				<p:menu model="#{sideMenu.model}" style="font-size:11pt;width:160px;"/>
			</h:form>
			
			<p:panel id="big-div">
	
<!-- Top Menu -->
				<br/>
				<h:form id="topMenuBar">
					<p:menubar styleClass="centeredMenuBar ui-widget-header ui-corner-all" model="#{topMenu.model}"
								style="top:0px;width:953px;position:fixed;transform: translateX(0%);z-index:+99;height:25px;" />
				</h:form>
				
				<br/><br/><br/><br/>
				
				<h:panelGroup layout="block" rendered="#{vertretungKonfig.allowed}">
					
					<p:panel id="panel" header="Vertretungsplan">
						
						<br/>
						<div class="ui-g">
				    		<div class="ui-g-6" style="text-align:center;">
				    			<h2 class="title">PDF-Datei</h2>
				    			<h:form enctype="multipart/form-data">
				    				<div class="ui-g">
							    		<div class="ui-g-6" style="text-align:right;">
							    			<p:fileUpload label="Hochladen" fileUploadListener="#{vertretungKonfig.upload}"
	                     							update="panel message" auto="true"
	                     							onstart="PF('overlayLoad').show()" oncomplete="PF('overlayLoad').hide()"/>
							    		</div>
							    		<div class="ui-g-6" style="text-align:left;">
							    			<p:commandButton value="Entfernen" action="#{vertretungKonfig.delete}" update="panel message"
							    					disabled="#{!konfig.vertretungVisible}" style="margin-top:4px;" icon="fa fa-trash"/>
							    		</div>
						    		</div>
								</h:form>
								<br/><br/>
								<h2 class="title">Zusatzinformation</h2>
								<h:form>
									<p:inputText value="#{vertretungKonfig.newInfo}" size="20" style="text-align:center"/>
					            	<p:commandButton value="Aktualisieren" action="#{vertretungKonfig.updateInfo}" update="panelVorschau message" style="margin-left:10px;"/>
				            	</h:form>
				    		</div>
				    		<div class="ui-g-6" style="text-align:center;">
				    			<br/>
				    			<h2 class="title">Vorschau</h2>
				    			<h:panelGroup layout="block" id="panelVorschau">
						    		<p:panel style="width:155px;margin:auto;" rendered="#{konfig.vertretungVisible}">
										<p:button href="#{konfig.vertretungURL}" target="_blank" value="Vertretungsplan" icon="ui-icon-document" style="font-size:11pt;margin-left:-15px;margin-bottom:5px"/>
										<br/>
										<div style="text-align:center">
											<p:outputLabel value="#{konfig.vertretungInfo}" style="font-size:11pt;"/>
										</div>
									</p:panel>
									<p:outputLabel value="(wird ausgeblendet)" rendered="#{!konfig.vertretungVisible}"/>
									<br/><br/>
									<p:outputLabel value="Vertretungsplan zuletzt verändert: " rendered="#{konfig.vertretungVisible}"/><br/>
									<p:outputLabel value="#{vertretungKonfig.lastModified}" style="font-weight:bold" rendered="#{konfig.vertretungVisible}"/>
								</h:panelGroup>
				    		</div>
				    	</div>
						
						<br/><br/><br/>
						<div style="text-align:center">
							Änderungen sind <b>sofort</b> öffentlich.
							<br/>
							Der Dateiname wird automatisch in "vertretungsplan.pdf" umbenannt.
							<h:panelGroup layout="block" rendered="#{vertretungKonfig.suggested}">
								<br/>
								<p:outputLabel value="Anhand der PDF wurde ein Datum ermittelt. Sie können es trotzdem ändern." style="color:green"/>
							</h:panelGroup>
						</div>
						<br/><br/>
					</p:panel>
					
					<br/><br/>
				</h:panelGroup>
				
				<br/>
				<br/>
				<br/>
			</p:panel>
			<p:dialog widgetVar="overlayLoad" modal="true" draggable="false" closable="false" resizable="false" showHeader="false">
				<h2 class="title" style="text-align:center">Verarbeitung</h2>
			    <p:graphicImage url="resources/img/ajax-loader.gif" />
			</p:dialog>
			<br/>
			<div id="bottom">
				<h:link outcome="kontakt" styleClass="ui-link ui-widget" style="font-size:10pt;color:#125100;text-decoration:none;" value="Kontakt"/>
				<p:outputLabel style="font-size:10pt" value=" | "/>
				<h:link outcome="impressum" styleClass="ui-link ui-widget" style="font-size:10pt;color:#125100;text-decoration:none;" value="Impressum"/>
				<p:outputLabel style="font-size:10pt" value=" | "/>
				<h:link outcome="sitemap" styleClass="ui-link ui-widget" style="font-size:10pt;color:#125100;text-decoration:none;" value="Sitemap"/>
				<br/><br/>
				<h:outputText style="font-size:12pt;word-wrap: break-word;" escape="false" value="#{konfig.bottomText}"/>
			</div>
			<br/>
		</div>
	</h:body>
</html>
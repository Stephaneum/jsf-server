<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<body>
	<ui:composition>

		<style>
			@media only screen and (max-width: 600px) {
				#logo-steph {
					height: 45px !important;
				}
			}
			
			.nav-button {
				color: #{themeService.navbarTextColor};
			}
	
			.single-highlight {
				color: white;
			}
			
			.single-highlight:hover {
				color: #4caf50;
			}
			
			.intern {
				background-color: #558b2f;
			}
			
			.intern:hover {
				background-color: #689f38;
			}
		</style>

		<script>
			$(document).ready(function() {
				$('.sidenav').sidenav();
			});
			
    		var activeID = null;
    		var hovering = {};
    		
    		function showNav(origin, id) {
    			//switch main group
    			if(activeID != null) {
    				$('#g-' + activeID).hide();
    			}
    			activeID = id;
    			$('#g-' + activeID).show();
    			
    			hovering[origin] = true;
    			
    			var depth = parseInt($('#g-'+id+'-flag').html());
    			
    			switch(depth) {
    			case 1: $('#g-'+id+'-title').removeClass("m3 m5"); $('#g-'+id+'-title').addClass('m6'); break;
    			case 2: $('#g-'+id+'-title').removeClass("m3 m6"); $('#g-'+id+'-title').addClass('m5'); break;
    			default: $('#g-'+id+'-title').removeClass("m5 m6"); $('#g-'+id+'-title').addClass('m3');
    			}
    			
    			//show nav-block if not yet shown
    			setTimeout(function() {
    				var hide = true;
	    			for (var key in hovering) {
	    			    if (hovering.hasOwnProperty(key)) {
	    			    	if(hovering[key]) {
	    			    		hide = false;
	    			    		break;
	    			    	}
	    			    }
	    			}
	    		
	    			if(!hide) {
	    				$('#nav-block').slideDown(350);
	    			}
    			}, 300);
    		}
    		
    		function hideNav(origin) {
    			hovering[origin] = false;
    			setTimeout(function() {
    				var hide = true;
	    			for (var key in hovering) {
	    			    if (hovering.hasOwnProperty(key)) {
	    			    	if(hovering[key]) {
	    			    		hide = false;
	    			    		break;
	    			    	}
	    			    }
	    			}
	    		
	    			if(hide) {
	    				$('#nav-block').slideUp(350);
	    			}
    			}, 400);
    		}
    		
    		var activeSection = [null,null];
    		var defaultColor = 'white-text';
    		var highlight = 'green-text';
    		function showNextSection(section, id) {
    			//switch section
    			if(activeSection[section] != null) {
    				if(activeSection[section] == id)
    					return; //same
    				$('#s-' + section + "-" + activeSection[section]).hide();
    				$('#s-' + section + "-" + activeSection[section] + "-parent").removeClass(highlight);
    				$('#s-' + section + "-" + activeSection[section] + "-parent").addClass(defaultColor);
    			}
    			activeSection[section] = id;
    			
    			if(section == 0) {
    				//reset all sections after that (the last one)
    				if(activeSection[1] != null) {
    					$('#s-' + 1 + "-" + activeSection[1]).hide();
    					$('#s-' + 1 + "-" + activeSection[1] + "-parent").removeClass(highlight);
    					$('#s-' + 1 + "-" + activeSection[1] + "-parent").addClass(defaultColor);
    					activeSection[1] = null;
    				}
    			}
    			
    			$('#s-' + section + "-" + id + "-parent").removeClass(defaultColor);
    			$('#s-' + section + "-" + id + "-parent").addClass(highlight);
    			$('#s-' + section + "-" + id).fadeIn(250);
    		}
    	</script>

		<nav>
			<div id="nav-panel" class="nav-wrapper"
				style="z-index: 100; background-color: #{themeService.navbarColor}">
				
				<a href="#" data-target="side-nav"
					class="sidenav-trigger hide-on-large-only">
					<h:panelGroup rendered="#{themeService.logoColored}">
						<i class="material-icons" style="color: #{themeService.navbarTextColor}">menu</i>
					</h:panelGroup>
					<h:panelGroup rendered="#{!themeService.logoColored}">
						<i class="material-icons">menu</i>
					</h:panelGroup>
				</a>
				<a href="home.xhtml"
				class="brand-logo"><h:graphicImage id="logo-steph"
					value="/resources/img/#{themeService.logo}"
					style="height:50px;margin-top:5px;margin-left:10px" /></a>
				<ul class="right hide-on-med-and-down">
					<ui:repeat value="#{topMenu.topLevel}" var="t">
						<li><h:link outcome="home" value="#{t.name}"
								rendered="#{not empty t.unterGruppe}"
								styleClass="nav-button"
								onmouseover="showNav('t-#{t.gruppe_id}',#{t.gruppe_id})"
								onmouseout="hideNav('t-#{t.gruppe_id}')">
								<f:param name="id" value="#{t.gruppe_id}" />
							</h:link> <h:link outcome="home" value="#{t.name}"
								rendered="#{empty t.unterGruppe}"
								styleClass="nav-button">
								<f:param name="id" value="#{t.gruppe_id}" />
							</h:link></li>
					</ui:repeat>
					
					<h:panelGroup rendered="#{konfig.loggedIn}">
						<li><a href="#!" onmouseover="showNav('t--1',-1)"
								onmouseout="hideNav('t--1')" class="intern">Intern</a></li>
					</h:panelGroup>
					
					<li>
						<h:link outcome="login"
							rendered="#{!konfig.loggedIn and !themeService.loginButtonColored}"
							value="Login"
							styleClass="waves-effect waves-dark btn white black-text">
							<i class="material-icons right">exit_to_app</i>
						</h:link>
						
						<h:link outcome="login"
							rendered="#{!konfig.loggedIn and themeService.loginButtonColored}"
							value="Login"
							styleClass="waves-effect waves-light btn"
							style="background-color: #{themeService.buttonColor}">
							<i class="material-icons right">exit_to_app</i>
						</h:link>
						
						<h:link outcome="logout"
							rendered="#{konfig.loggedIn and !themeService.loginButtonColored}"
							value="Abmelden"
							styleClass="waves-effect waves-dark btn white black-text">
							<i class="material-icons right">exit_to_app</i>
						</h:link>
						
						<h:link outcome="logout"
							rendered="#{konfig.loggedIn and themeService.loginButtonColored}"
							value="Abmelden"
							styleClass="waves-effect waves-dark btn"
							style="background-color: #{themeService.buttonColor}">
							<i class="material-icons right">exit_to_app</i>
						</h:link>
					</li>
				</ul>
			</div>
		</nav>
		
		<!-- sections -->

		<div id="nav-block" style="display: none; background-color: #{themeService.navbarDropdownColor}"
			onmouseover="hovering['nav-block'] = true"
			onmouseout="hideNav('nav-block')">
			
			<ui:repeat value="#{topMenu.topLevel}" var="g">
				<div id="g-#{g.gruppe_id}" style="display: none">
					<p id="g-#{g.gruppe_id}-flag" style="display:none">#{g.depth}</p>
					<div class="row" style="margin-bottom: 0">
						<div id="g-#{g.gruppe_id}-title" class="col m3 right-align">
							<h5 class="white-text">#{g.name}</h5>
						</div>
						<div class="col m3">
							<br/>
							<ui:repeat value="#{g.unterGruppe}" var="g2">
								<h:panelGroup layout="block" rendered="#{not empty g2.unterGruppe}">
									<a id="s-0-#{g2.gruppe_id}-parent" class="white-text"
									href="home.xhtml?id=#{g2.gruppe_id}"
									onmouseover="showNextSection(0,#{g2.gruppe_id})" >
									<span>#{g2.name}</span>
									<i class="fa fa-arrow-right"></i>
									</a>
									<br/>
								</h:panelGroup>
								<h:panelGroup layout="block" rendered="#{empty g2.unterGruppe and empty g2.link}">
									<a id="s-0-#{g2.gruppe_id}-parent" class="white-text"
									href="home.xhtml?id=#{g2.gruppe_id}"
									onmouseover="showNextSection(0,#{g2.gruppe_id})">
									#{g2.name}
									</a>
									<br/>
								</h:panelGroup>
								<h:panelGroup layout="block" rendered="#{empty g2.unterGruppe and not empty g2.link}">
									<a id="s-0-#{g2.gruppe_id}-parent" class="white-text"
									href="#{g2.link}"
									onmouseover="showNextSection(0,#{g2.gruppe_id})">
									#{g2.name}
									</a>
									<br/>
								</h:panelGroup>
							</ui:repeat>
							<br/>
						</div>

						<div class="col m3">
							<ui:repeat value="#{g.unterGruppe}" var="g2">
								<div id="s-0-#{g2.gruppe_id}" style="margin-left: 20px; display:none">
									
									<h:panelGroup layout="block" rendered="#{not empty g2.unterGruppe}">
										<h5 class="white-text">#{g2.name}</h5>
										<ui:repeat value="#{g2.unterGruppe}" var="g3">
										
											<h:panelGroup layout="block" rendered="#{not empty g3.unterGruppe}">
												<a id="s-1-#{g3.gruppe_id}-parent" class="white-text"
												href="home.xhtml?id=#{g3.gruppe_id}"
												onmouseover="showNextSection(1,#{g3.gruppe_id})" >
												<span>#{g3.name}</span>
												<i class="fa fa-arrow-right"></i>
												</a>
												<br/>
											</h:panelGroup>
											<h:panelGroup layout="block" rendered="#{empty g3.unterGruppe and empty g3.link}">
												<a id="s-1-#{g3.gruppe_id}-parent" class="white-text"
												href="home.xhtml?id=#{g3.gruppe_id}"
												onmouseover="showNextSection(1,#{g3.gruppe_id})" >
												#{g3.name}
												</a>
												<br/>
											</h:panelGroup>
											<h:panelGroup layout="block" rendered="#{empty g3.unterGruppe and not empty g3.link}">
												<a id="s-1-#{g3.gruppe_id}-parent" class="white-text"
												href="#{g3.link}"
												onmouseover="showNextSection(1,#{g3.gruppe_id})">
												#{g3.name}
												</a>
												<br/>
											</h:panelGroup>
	
										</ui:repeat>
									</h:panelGroup>
								</div>
							</ui:repeat>
							<br/>
						</div>

						<div class="col m3">

							<ui:repeat value="#{g.unterGruppe}" var="g2">
								<ui:repeat value="#{g2.unterGruppe}" var="g3">
									<div id="s-1-#{g3.gruppe_id}" style="margin-left: 20px; display:none">
										<h:panelGroup layout="block" rendered="#{not empty g3.unterGruppe}">
											<h5 class="white-text">#{g3.name}</h5>
											<ui:repeat value="#{g3.unterGruppe}" var="g4">
												<h:panelGroup layout="block" rendered="#{empty g4.link}">
													<a id="s-2-#{g4.gruppe_id}-parent" class="single-highlight"
													href="home.xhtml?id=#{g4.gruppe_id}">
													#{g4.name}
													</a>
													<br/>
												</h:panelGroup>
												<h:panelGroup layout="block" rendered="#{not empty g4.link}">
													<a id="s-2-#{g4.gruppe_id}-parent" class="single-highlight"
													href="#{g4.link}">
													#{g4.name}
													</a>
													<br/>
												</h:panelGroup>
											</ui:repeat>
										</h:panelGroup>
									</div>
								</ui:repeat>
							</ui:repeat>
						</div>
					</div>
				</div>
			</ui:repeat>
			
			<h:panelGroup rendered="#{konfig.loggedIn}">
				<div id="g--1" style="display: none">
					<p id="g--1-flag" style="display:none">#{topMenu.flagDepth}</p>
					<div class="row" style="margin-bottom: 0">
						<div id="g--1-title" class="col m3 center-align">
							<br/>
							<p style="display: inline-block; background: #2e7d32; color: white; font-size: 16pt; padding: 10px; margin-bottom: 0; border-radius: 15px;">#{konfig.fullName}</p>
							<p class="white-text">#{konfig.nutzer.rangString}</p>
						</div>
						
						<h:panelGroup layout="block" styleClass="col m3" rendered="#{topMenu.admin}">
							<br/>
							<h5 class="white-text">Admin</h5>
							<a href="admin_konfig.xhtml" class="single-highlight"><i class="fa fa-cog" aria-hidden="true"></i> Konfiguration</a><br/>
							<a href="admin_backup.xhtml" class="single-highlight"><i class="fa fa-medkit" aria-hidden="true"></i> Backup</a><br/>
							<a href="admin_rubriken.xhtml" class="single-highlight"><i class="fa fa-filter" aria-hidden="true"></i> Rubriken</a><br/>
							<a href="admin_zugangscode.xhtml" class="single-highlight"><i class="fa fa-key" aria-hidden="true"></i> Zugangscodes</a><br/>
							<a href="admin_nutzer.xhtml" class="single-highlight"><i class="fa fa-users" aria-hidden="true"></i> Nutzer</a><br/>
							<a href="admin_logs.xhtml" class="single-highlight"><i class="fa fa-book" aria-hidden="true"></i> Logbuch</a><br/>
							<br/>
						</h:panelGroup>
						
						<h:panelGroup layout="block" styleClass="col m3" rendered="#{!topMenu.admin and topMenu.vertretungsplan}">
							<br/>
							<h5 class="white-text">Konfiguration</h5>
							<a href="konfig_vertretung.xhtml" class="single-highlight"><i class="fa fa-file-text" aria-hidden="true"></i> Vertretungsplan</a><br/>
							<br/>
						</h:panelGroup>
						
						<div class="col m3">
							<br/>
							<h5 class="white-text">Nutzer</h5>
							<h:panelGroup rendered="#{topMenu.rubrikErstellen}">
								<a href="nutzer_rubrik.xhtml" class="single-highlight"><i class="fa fa-star" aria-hidden="true"></i> Rubrik</a><br/>
							</h:panelGroup>
							<a href="nutzer_beitrag.xhtml" class="single-highlight"><i class="fa fa-pencil-square" aria-hidden="true"></i> Beiträge</a><br/>
							<a href="nutzer_dateien.xhtml" class="single-highlight"><i class="fa fa-folder-open" aria-hidden="true"></i> Dateien</a><br/>
							<a href="nutzer_account.xhtml" class="single-highlight"><i class="fa fa-address-card" aria-hidden="true"></i> Account</a><br/>
							<br/>
						</div>
						
						<div class="col m3">
							<br/>
							<h5 class="white-text">Gruppen</h5>
							<a href="klasse.xhtml" class="single-highlight"><i class="fa fa-users" aria-hidden="true"></i> Klassen</a><br/>
							<a href="projekt_all.xhtml" class="single-highlight"><i class="fa fa-comments" aria-hidden="true"></i> Projekte</a><br/>
							<br/>
						</div>
						
					</div>
				</div>
			</h:panelGroup>
		</div>

		<ul class="sidenav" id="side-nav">
			<br />
			<li><a href="home.xhtml"><i class="material-icons">home</i>Startseite</a></li>
			<h:panelGroup rendered="#{!konfig.loggedIn}">
				<li><a href="login.xhtml"><i class="material-icons">exit_to_app</i>Login</a></li>
			</h:panelGroup>
			<h:panelGroup rendered="#{konfig.loggedIn}">
				<li><a href="logout.xhtml"><i class="material-icons">exit_to_app</i>Abmelden</a></li>
			</h:panelGroup>
			<li><a href="termine.xhtml"><i class="material-icons">date_range</i>Termine</a></li>
			
			<h:panelGroup rendered="#{konfig.vertretungVisible}">
				<li><div class="divider"></div></li>
				<li><a class="subheader">Vertretungsplan</a></li>
				<li><a href="vertretungsplan.pdf"><i class="material-icons">description</i>#{konfig.vertretungInfo}</a></li>
			</h:panelGroup>
			
			<li><div class="divider"></div></li>
			<li><a class="subheader">weitere Links</a></li>
			<ui:repeat value="#{topMenu.topLevel}" var="t">
				<li><a href="home.xhtml?id=#{t.gruppe_id}">#{t.name}</a></li>
			</ui:repeat>
		</ul>

	</ui:composition>
</body>
</html>
